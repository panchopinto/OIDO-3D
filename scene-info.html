<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>3D con información — Oído</title>
  <link rel="stylesheet" href="css/styles.css"/>
  <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
</head>
<body>
  
<!-- v14: Figure icons (badge-like) -->
<svg width="0" height="0" style="position:absolute">
  <defs>
    <linearGradient id="bg-blue" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#93c5fd"/><stop offset="100%" stop-color="#3b82f6"/>
    </linearGradient>
    <linearGradient id="bg-green" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#6ee7b7"/><stop offset="100%" stop-color="#10b981"/>
    </linearGradient>
    <linearGradient id="bg-orange" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#fcd34d"/><stop offset="100%" stop-color="#f59e0b"/>
    </linearGradient>
    <linearGradient id="bg-purple" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#c4b5fd"/><stop offset="100%" stop-color="#8b5cf6"/>
    </linearGradient>
  </defs>
</svg>
<svg width="0" height="0" style="position:absolute">
  <!-- Home badge (house) -->
  <symbol id="fig-home" viewBox="0 0 64 64">
    <circle cx="32" cy="32" r="28" fill="url(#bg-purple)"/>
    <path d="M20 34v14h10V38h4v10h10V34h4L32 20 16 34h4z" fill="#fff" opacity="0.95"/>
  </symbol>
  <!-- 3D badge (cube) -->
  <symbol id="fig-3d" viewBox="0 0 64 64">
    <circle cx="32" cy="32" r="28" fill="url(#bg-blue)"/>
    <path d="M32 14l16 9v18l-16 9-16-9V23l16-9zm0 6l-10 5v10l10 5 10-5V25l-10-5z" fill="#fff" opacity="0.95"/>
  </symbol>
  <!-- Info badge (book/info) -->
  <symbol id="fig-info" viewBox="0 0 64 64">
    <circle cx="32" cy="32" r="28" fill="url(#bg-green)"/>
    <path d="M30 18h4v6h-4zM30 28h4v18h-4z" fill="#0b3" opacity="0.0"/>
    <path d="M32 16a16 16 0 1 0 .001 32.001A16 16 0 0 0 32 16zm-2 8h4v6h-4zm0 10h4v12h-4z" fill="#fff" opacity="0.95"/>
  </symbol>
  <!-- AR badge (phone/AR) -->
  <symbol id="fig-ar" viewBox="0 0 64 64">
    <circle cx="32" cy="32" r="28" fill="url(#bg-orange)"/>
    <rect x="20" y="18" width="24" height="28" rx="4" ry="4" fill="#fff" opacity="0.95"/>
    <path d="M26 24h12v4H26zM24 32h16v2H24zM24 36h16v2H24z" fill="#f59e0b"/>
  </symbol>
</svg>

  
<svg width="0" height="0" style="position:absolute">
  <defs>
    <linearGradient id="g-blue" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#60a5fa"/><stop offset="100%" stop-color="#3b82f6"/></linearGradient>
    <linearGradient id="g-green" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#34d399"/><stop offset="100%" stop-color="#10b981"/></linearGradient>
    <linearGradient id="g-orange" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#fbbf24"/><stop offset="100%" stop-color="#f59e0b"/></linearGradient>
    <linearGradient id="g-purple" x1="0" y1="0" x2="1" y2="1"><stop offset="0%" stop-color="#c084fc"/><stop offset="100%" stop-color="#8b5cf6"/></linearGradient>
  </defs>
</svg>
<svg width="0" height="0" style="position:absolute">
  <symbol id="ico-home" viewBox="0 0 24 24"><path fill="url(#g-purple)" d="M12 3l9 8h-3v9h-5v-6h-2v6H6v-9H3l9-8z"/></symbol>
  <symbol id="ico-3d" viewBox="0 0 24 24"><path fill="url(#g-blue)" d="M12 2l9 5v10l-9 5-9-5V7l9-5zm0 2.2L5 7v8l7 3.8 7-3.8V7L12 4.2z"/></symbol>
  <symbol id="ico-info" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="url(#g-green)" stroke-width="2"/><path fill="url(#g-green)" d="M11 10h2v7h-2zM11 6h2v2h-2z"/></symbol>
  <symbol id="ico-ar" viewBox="0 0 24 24"><path fill="url(#g-orange)" d="M12 2l7 4v12l-7 4-7-4V6l7-4zm0 2.2L7 6.5v7l5 2.8 5-2.8v-7L12 4.2z"/></symbol>
</svg>

  <div class="container">
    <header class="header">
      <div class="brand"><div class="logo"><svg viewBox="0 0 24 24"><use href="#fig-info"/></svg></div><h1>3D con información — Oído</h1></div>
      
      <nav class="actions">
        <a class="btn grad-purple" href="index.html"><svg class="ico-badge"><use href="#fig-home"/></svg> Inicio</a>
        <a class="btn grad-blue" href="scene-simple.html"><svg class="ico-badge"><use href="#fig-3d"/></svg> Vista 3D simple</a>
        <a class="btn grad-green" href="scene-info.html"><svg class="ico-badge"><use href="#fig-info"/></svg> 3D con información</a>
        <a class="btn grad-orange" href="ar.html"><svg class="ico-badge"><use href="#fig-ar"/></svg> Realidad Aumentada</a>
      </nav>
    
    </header>

    <section class="card">
      <div class="toolbar">
            <button class="toolbtn" id="btn-prev" title="Anterior">
              <svg viewBox="0 0 24 24"><path fill="#7dd3fc" d="M15 6l-6 6 6 6V6z"/></svg>
            </button>
            <button class="toolbtn" id="btn-play" title="Iniciar tour">
              <svg viewBox="0 0 24 24"><path fill="#34d399" d="M8 5v14l11-7z"/></svg>
            </button>
            <button class="toolbtn" id="btn-pause" title="Pausar tour">
              <svg viewBox="0 0 24 24"><path fill="#f59e0b" d="M7 5h4v14H7zM13 5h4v14h-4z"/></svg>
            </button>
            <button class="toolbtn" id="btn-next" title="Siguiente">
              <svg viewBox="0 0 24 24"><path fill="#7dd3fc" d="M9 6l6 6-6 6V6z"/></svg>
            </button>
          </div>
            <button class="toolbtn" id="btn-info" title="Ver info">
              <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" fill="none" stroke="#7dd3fc" stroke-width="2"/><path fill="#7dd3fc" d="M11 10h2v7h-2zM11 6h2v2h-2z"/></svg>
            </button>
            <button class="toolbtn" id="btn-auto" title="Auto-rotar">
              <svg viewBox="0 0 24 24"><path fill="#34d399" d="M12 2v3l4-4-4-4v3A10 10 0 1022 12h-2a8 8 0 11-8-8z"/></svg>
            </button>
            <button class="toolbtn" id="btn-zoom-in" title="Acercar (+)">
              <svg viewBox="0 0 24 24"><path fill="#60a5fa" d="M10 10V6h2v4h4v2h-4v4h-2v-4H6v-2z"/><path fill="#60a5fa" d="M21 21l-4.35-4.35"/></svg>
            </button>
            <button class="toolbtn" id="btn-zoom-out" title="Alejar (-)">
              <svg viewBox="0 0 24 24"><path fill="#fbbf24" d="M6 11h8v2H6z"/><path fill="#fbbf24" d="M21 21l-4.35-4.35"/></svg>
            </button>
            <button class="toolbtn" id="btn-reset" title="Reiniciar vista">
              <svg viewBox="0 0 24 24"><path fill="#c084fc" d="M12 5V2L7 6l5 4V7c3 0 5 2 5 5a5 5 0 11-9.9 1H5a7 7 0 1014 0c0-3.87-3.13-7-7-7z"/></svg>
            </button>
            <button class="toolbtn" id="btn-hotspots" title="Mostrar/Ocultar etiquetas">
              <svg viewBox="0 0 24 24"><path fill="#e879f9" d="M12 5c4 0 7 3 7 7s-3 7-7 7-7-3-7-7 3-7 7-7zm0 2a5 5 0 100 10 5 5 0 000-10z"/><circle cx="12" cy="12" r="2" fill="#e879f9"/></svg>
            </button>
          </div>
          <mv-wrapper>
        <model-viewer id="mv" src="assets/models/oido.glb" camera-controls touch-action="pan-y" exposure="1.1" shadow-intensity="0.5">
          <button class="hotspot" slot="hotspot-1" data-position="-0.05 0.06 -0.08" data-normal="0 1 0" data-visibility-attribute="visible">Pabellón auricular</button>
          <button class="hotspot" slot="hotspot-2" data-position="0 0.02 -0.05" data-normal="0 1 0" data-visibility-attribute="visible">Tímpano</button>
          <button class="hotspot" slot="hotspot-3" data-position="0.03 0.02 -0.05" data-normal="0 1 0" data-visibility-attribute="visible">Cadena osicular</button>
          <button class="hotspot" slot="hotspot-4" data-position="0.08 -0.01 -0.08" data-normal="0 1 0" data-visibility-attribute="visible">Cóclea</button>
          <button class="hotspot" slot="hotspot-5" data-position="0.11 0.03 -0.09" data-normal="0 1 0" data-visibility-attribute="visible">Canales semicirculares</button>
          <button class="hotspot" slot="hotspot-6" data-position="-0.02 -0.03 -0.04" data-normal="0 1 0" data-visibility-attribute="visible">Trompa de Eustaquio</button>
        </model-viewer>
      </mv-wrapper>
      <div class="panel" id="info-panel">
        <h3 id="info-title">Partes del oído</h3>
        <p id="info-desc">Toca un hotspot o usa el botón <em>info</em> para ver una breve descripción.</p>
        <div class="chipline">
          <span class="chip green">Externo</span><span class="chip blue">Medio</span><span class="chip orange">Interno</span>
        </div>
      </div>
      <p class="legend">Toca los hotspots para identificar cada parte del oído.</p>
    </section>

    <footer class="footer">
  <small>Proyecto desarrollado por <strong>Belén Acuña</strong> y <strong>Francisco Pinto</strong>. Uso exclusivamente educativo. <strong>Prohibida</strong> su reproducción, copia o distribución total o parcial sin autorización. © 2025</small>
</footer>
  </div>
  
<script>
(function(){
  const block = (e)=>{ e.preventDefault(); e.stopPropagation(); return false; };
  document.addEventListener('contextmenu', block, {capture:true});
  document.addEventListener('keydown', function(e){
    const k = e.key.toLowerCase();
    if (k === 'f12') return block(e);
    if (e.ctrlKey && e.shiftKey && ['i','j','c'].includes(k)) return block(e);
    if (e.ctrlKey && ['u','s','p'].includes(k)) return block(e);
  }, {capture:true});
})();
</script>


<script>
(function(){
  const mv = document.getElementById('mv');
  const infoPanel = document.getElementById('info-panel');
  const titleEl = document.getElementById('info-title');
  const descEl  = document.getElementById('info-desc');

  // Dictionary with brief info
  const INFO = {
    "Pabellón auricular": "Parte externa que capta y canaliza el sonido hacia el conducto auditivo.",
    "Tímpano": "Membrana que vibra con las ondas sonoras; separa el oído externo del medio.",
    "Cadena osicular": "Martillo, yunque y estribo; amplifican la vibración del tímpano.",
    "Cóclea": "Convierte vibraciones en impulsos nerviosos (audición).",
    "Canales semicirculares": "Detectan la rotación de la cabeza; fundamentales para el equilibrio.",
    "Trompa de Eustaquio": "Equilibra la presión entre oído medio y ambiente."
  };

  // Hotspot click binding
  mv.addEventListener('click', (ev)=>{
    const target = ev.target;
    if (target.classList && target.classList.contains('hotspot')){
      const name = target.textContent.trim();
      titleEl.textContent = name;
      descEl.textContent  = INFO[name] || "Parte del oído.";
    }
  });

  // Helpers
  function getOrbit(){
    const o = mv.getCameraOrbit(); // returns {theta, phi, radius}
    return {theta: o.theta, phi: o.phi, radius: o.radius};
  }
  function setOrbit(theta, phi, radius){
    mv.cameraOrbit = `${'${'}theta${'}'} ${'${'}phi${'}'} ${'${'}radius${'}'}`;
  }

  // Buttons
  const btnInfo = document.getElementById('btn-info');
  const btnAuto = document.getElementById('btn-auto');
  const btnIn   = document.getElementById('btn-zoom-in');
  const btnOut  = document.getElementById('btn-zoom-out');
  const btnRes  = document.getElementById('btn-reset');
  const btnHot  = document.getElementById('btn-hotspots');

  btnInfo.addEventListener('click', ()=>{
    infoPanel.scrollIntoView({behavior:'smooth', block:'center'});
    infoPanel.classList.add('pulse');
    setTimeout(()=> infoPanel.classList.remove('pulse'), 600);
  });

  btnAuto.addEventListener('click', ()=>{
    mv.autoRotate = !mv.autoRotate;
  });

  btnIn.addEventListener('click', ()=>{
    const o = getOrbit();
    // reduce radius 10%
    const r = Math.max(0.05, o.radius * 0.9);
    setOrbit(o.theta, o.phi, r);
  });

  btnOut.addEventListener('click', ()=>{
    const o = getOrbit();
    const r = Math.min(10, o.radius * 1.1);
    setOrbit(o.theta, o.phi, r);
  });

  btnRes.addEventListener('click', ()=>{
    mv.resetTurntableRotation();
    mv.cameraOrbit = 'auto auto auto';
  });

  let hotspotsVisible = true;
  btnHot.addEventListener('click', ()=>{
    hotspotsVisible = !hotspotsVisible;
    mv.querySelectorAll('.hotspot').forEach(h=>{
      h.style.display = hotspotsVisible ? 'inline-block' : 'none';
    });
  });
})();
</script>


<script>
// TOUR_AUTOMATICO v13
(function(){
  const mv = document.getElementById('mv');
  if(!mv) return;
  const btnPrev = document.getElementById('btn-prev');
  const btnNext = document.getElementById('btn-next');
  const btnPlay = document.getElementById('btn-play');
  const btnPause= document.getElementById('btn-pause');
  const titleEl = document.getElementById('info-title');
  const descEl  = document.getElementById('info-desc');

  const INFO = {
    "Pabellón auricular": "Parte externa que capta y canaliza el sonido hacia el conducto auditivo.",
    "Tímpano": "Membrana que vibra con las ondas sonoras; separa el oído externo del medio.",
    "Cadena osicular": "Martillo, yunque y estribo; amplifican la vibración del tímpano.",
    "Cóclea": "Convierte vibraciones en impulsos nerviosos (audición).",
    "Canales semicirculares": "Detectan rotación de la cabeza; esenciales para el equilibrio.",
    "Trompa de Eustaquio": "Equilibra la presión entre oído medio y ambiente."
  };

  function parsePos(str){
    const p = str.trim().split(/\s+/).map(Number);
    return {x:p[0]||0, y:p[1]||0, z:p[2]||0};
  }
  function posToTarget(p){ return `${p.x}m ${p.y}m ${p.z}m`; }

  // Collect steps from hotspots in DOM order
  const hotspots = Array.from(mv.querySelectorAll('.hotspot'));
  const steps = hotspots.map(el=>{
    const name = el.textContent.trim();
    const pos  = parsePos(el.dataset.position||"0 0 0");
    return {name, pos, el};
  });

  let idx = 0;
  let timer = null;
  const DUR = 3200; // ms between steps

  function focusStep(i){
    if(steps.length===0) return;
    idx = (i+steps.length)%steps.length;
    const st = steps[idx];
    // Update info panel
    titleEl.textContent = st.name;
    descEl.textContent  = INFO[st.name] || 'Parte del oído';
    // Set camera target to hotspot position, slightly adjust radius
    const o = mv.getCameraOrbit();
    const newRadius = Math.max(0.08, o.radius*0.85);
    mv.cameraTarget = posToTarget(st.pos);
    mv.cameraOrbit = `${o.theta} ${o.phi} ${newRadius}`;
    // small highlight
    st.el.style.transform = 'scale(1.08)';
    setTimeout(()=> st.el.style.transform = '', 250);
  }

  function play(){
    if(timer) return;
    mv.autoRotate = false;
    focusStep(idx);
    timer = setInterval(()=>{ focusStep(idx+1); }, DUR);
  }
  function pause(){
    if(timer){ clearInterval(timer); timer = null; }
  }
  function next(){ pause(); focusStep(idx+1); }
  function prev(){ pause(); focusStep(idx-1); }

  btnPlay && btnPlay.addEventListener('click', play);
  btnPause&& btnPause.addEventListener('click', pause);
  btnNext && btnNext.addEventListener('click', next);
  btnPrev && btnPrev.addEventListener('click', prev);

  // Clicking a hotspot interrupts tour and focuses that part
  mv.addEventListener('click', (ev)=>{
    if(ev.target.classList && ev.target.classList.contains('hotspot')){
      pause();
      const i = steps.findIndex(s=> s.el===ev.target);
      if(i>=0){ focusStep(i); }
    }
  });
})();
</script>

</body>
</html>
